webpackJsonp([9],{pxli:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={data:function(){return{totalCount:0,list:[],listLoading:!1,listQuery:{pageNum:1,pageRow:10,psnname:"",psncode:""},dialogStatus:"create",dialogFormVisible:!1,textMap:{update:"绑定IC卡号",create:"绑定用户卡号"},tempDriver:{username:"",psncode:"",icnumber:"",dindex:""}}},created:function(){this.getList()},methods:{sysnData:function(){var e=this;this.api({url:"/paibanuser/sysnPaiBanUser",method:"get"}).then(function(t){alert("同步数据成功"),e.getList()})},getList:function(){var e=this;this.listLoading=!0,this.api({url:"/paibanuser/listPaiBanUser",method:"get",params:this.listQuery}).then(function(t){e.listLoading=!1,e.list=t.list,e.totalCount=t.totalCount})},showUpdate:function(e){var t=this.list[e];this.tempDriver.username=t.psnname,this.tempDriver.psncode=t.psncode,this.tempDriver.icnumber=t.icnumber,this.tempDriver.dindex=e,this.dialogStatus="update",this.dialogFormVisible=!0},bindic:function(){var e=this,t=this.tempDriver.dindex,i=!0,n="";if(console.info(this.tempDriver.icnumber),console.info(e.list[t].icnumber),""==this.tempDriver.icnumber||this.tempDriver.icnumber==e.list[t].icnumber?(i=!1,n="卡号未改变或者为空,不能提交!"):10!=this.tempDriver.icnumber.length&&(i=!1,n="卡号长度不规范!"),0==i)return e.$message({message:n,type:"error",duration:1e3}),!1;this.api({url:"/driveric/bindic",method:"post",params:this.tempDriver}).then(function(t){var i="success";1==t.cknum?(n="已存在该卡号!",i="error"):1==t.result?(n="绑定成功!",e.dialogFormVisible=!1):(e.dialogFormVisible=!1,n="绑定失败!"),e.$message({message:n,type:i,duration:1e3,onClose:function(){e.getList()}})})},handleSizeChange:function(e){this.listQuery.pageRow=e,this.handleFilter()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.getList()},handleFilter:function(){this.listQuery.pageNum=1,this.getList()},getIndex:function(e){return(this.listQuery.pageNum-1)*this.listQuery.pageRow+e+1}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{attrs:{inline:!0}},[i("el-form-item",{attrs:{label:"姓名"}},[i("el-input",{attrs:{placeholder:"姓名"},model:{value:e.listQuery.psnname,callback:function(t){e.$set(e.listQuery,"psnname",t)},expression:"listQuery.psnname"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"工号"}},[i("el-input",{attrs:{placeholder:"工号"},model:{value:e.listQuery.psncode,callback:function(t){e.$set(e.listQuery,"psncode",t)},expression:"listQuery.psncode"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.getList}},[e._v("查询\n        ")])],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.sysnData}},[e._v("同步数据\n        ")])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(e.getIndex(t.$index))}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"姓名",prop:"psnname",width:"100px;"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"性别",prop:"sex",width:"100px;"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"资格证号",prop:"certificateno"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"工号",prop:"psncode",width:"150"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"旧工号",prop:"oldpsncode",width:"150"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"IC卡号",prop:"icnumber",width:"150"}}),e._v(" "),e.hasPerm("driver:bindic")?i("el-table-column",{attrs:{align:"center",label:"管理",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",icon:"edit"},on:{click:function(i){e.showUpdate(t.$index)}}},[e._v("绑卡")])]}}])}):e._e()],1),e._v(" "),i("el-pagination",{attrs:{"current-page":e.listQuery.pageNum,"page-size":e.listQuery.pageRow,total:e.totalCount,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{staticClass:"small-space",staticStyle:{width:"300px","margin-left":"50px"},attrs:{model:e.tempDriver,"label-position":"left","label-width":"80px"}},[i("el-form-item",{attrs:{label:"姓名"}},[e._v(e._s(e.tempDriver.username))]),e._v(" "),i("el-form-item",{attrs:{label:"工号"}},[e._v(e._s(e.tempDriver.psncode))]),e._v(" "),i("el-form-item",{attrs:{label:"IC卡号"}},[i("el-input",{attrs:{type:"text"},model:{value:e.tempDriver.icnumber,callback:function(t){e.$set(e.tempDriver,"icnumber",t)},expression:"tempDriver.icnumber"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.bindic}},[e._v("绑 定")])],1)],1)],1)},staticRenderFns:[]},l=i("VU/8")(n,r,!1,null,null,null);t.default=l.exports}});